<div class="row">
	<div class="col-lg-12">
		<div class="page-header">
			<h1><%= @server.name %></h1>
		</div>
	</div>
</div>
<% if @server.busy? %>
	<%= render partial: 'busy' %>
<% else %>
	<div class="row">
		<% if @server.remote_setup_stage == 0 %>
			<div class="col-lg-12">
				<h3>Something went wrong setting up this server</h3>
			</div>
		<% elsif @server.remote_setup_stage == 1 %>
			<div class="col-lg-12">
				<h3>Finish setting up your server</h3>
				<ol>
					<li>SSH into your new server (<code>ssh mcuser@<%= @server.droplet.ip_address %></code>). Your password is the name of your server (<code><%= @server.name %></code>). If you are prompted about a "fingerprint", choose "yes"<ul>
						<li>OSX: run the command in the Terminal app. By default, this is in the "Other" folder in the Launchpad</li>
						<li>Linux: run the command in your shell/terminal (e.g. gnome-terminal, xterm)</li>
						<li>Windows: download <%= link_to 'PuTTY', 'http://www.putty.org/' %> (putty.exe) and SSH using the following credentials<dl>
							<dt>user</dt><dd>mcuser</dd>
							<dt>host</dt><dd><%= @server.droplet.ip_address %></dd>
							<dt>port</dt><dd>22</dd>
						</dl></li>
					</ul></li>
					<li>Run <code>wget -O /tmp/gamocosm.sh https://raw.githubusercontent.com/Raekye/Gamocosm/master/sysadmin/gamocosm-server_base.sh &amp;&amp; chmod +x /tmp/gamocosm.sh &amp;&amp; sudo /tmp/gamocosm.sh</code></li>
				</ol>
				<%= simple_form_for @server, url: minecraft_server_path(@server) do |f| %>
					<%= f.input :remote_setup_stage, as: :hidden, :input_html => { value: 2 } %>
					<button class="btn btn-success" type="submit">
						I did it! <i class="fa fa-check"></i>
					</button>
				<% end %>
			</div>
		<% else %>
			<div class="col-lg-9">
				<ul class="nav nav-tabs">
					<li class="active"><%= link_to 'Profile', minecraft_server_path(@server, anchor: 'profile'), 'data-toggle' => 'tab' %></li>
					<li><%= link_to 'Minecraft Settings', minecraft_server_path(@server, anchor: 'settings'), 'data-toggle' => 'tab' %></li>
					<li><%= link_to 'FTP and SSH Access', minecraft_server_path(@server, anchor: 'ftp_ssh'), 'data-toggle' => 'tab' %></li>
				</ul>

				<div class="tab-content">
					<div class="tab-pane active" id="profile">
						<%= render partial: 'profile' %>
					</div>
					<div class="tab-pane" id="settings">
						<%= render partial: 'settings' %>
					</div>
					<div class="tab-pane" id="ftp_ssh">
						<%= render partial: 'ftp_ssh' %>
					</div>
				</div>
			</div>

			<div class="col-lg-3">
				<%= panel_with_heading 'Control Panel' do %>
					<%= link_to 'Start', start_minecraft_server_path(@server), class: "btn btn-success btn-block #{@server.droplet_running? ? 'disabled' : ''}" %>
					<%= link_to 'Stop', stop_minecraft_server_path(@server), class: "btn btn-danger btn-block #{@server.droplet_running? ? '' : 'disabled'}" %>
					<hr />
					<%= link_to 'Resume', resume_minecraft_server_path(@server), class: "btn btn-success btn-block #{@server.droplet_running? ? '' : 'disabled'}" %>
					<%= link_to 'Pause', pause_minecraft_server_path(@server), class: "btn btn-info btn-block #{@server.droplet_running? ? '' : 'disabled'}" %>
					<hr />
					<%= link_to 'Backup', backup_minecraft_server_path(@server), class: "btn btn-success btn-block #{@server.droplet_running? ? '' : 'disabled'}" %>
					<%= link_to 'Download world', download_minecraft_server_path(@server), class: "btn btn-info btn-block #{@server.droplet_running? ? '' : 'disabled'}" %>
					<hr />
					<%= link_to 'Delete', minecraft_server_path(@server), method: :delete, class: 'btn btn-danger btn-block', data: { confirm: 'Are you sure you want to delete this server forever? (A really long time!)' } %>
				<% end %>
			</div>
		<% end %>
	</div>
<% end %>
